<!DOCTYPE html>
<html>

<head>
    <title style="color: #023047;">Rating Books</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #8ECAE6;
            padding: 20px;
            min-height: 100vh;
            flex-direction: column;

        }

        .navbar {
            background-color: #FFB703;
            padding: 10px 20px;
            /* ช่องว่างรอบๆ */
            display: flex;
            /* ใช้ flexbox เพื่อจัดตำแหน่ง */
            justify-content: space-between;
            /* จัดให้ฝั่งซ้ายและขวาอยู่ห่างกัน */
            align-items: center;
            /* จัดให้ทุกองค์ประกอบอยู่ในแนวกลางตามแกน Y */
            position: fixed;
            /* ทำให้ navbar อยู่ที่ตำแหน่งคงที่ */
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            /* ทำให้ navbar อยู่เหนือ sidebar */
        }

        .left-section {
            display: flex;
            align-items: center;
            /* จัดให้เมนูและโลโก้อยู่ในแนวเดียวกัน */
        }

        .Logo {
            width: 50px;
            /* ขนาดของโลโก้ */
            height: auto;
        }

        .right-section {
            display: flex;
            align-items: center;
            /* จัดให้ปุ่ม Add Friend, ช่องค้นหา, และไอคอนผู้ใช้อยู่ในแถวเดียวกัน */
            justify-content: flex-end;
            /* จัดให้อยู่ทางขวาสุด */
            gap: 10px;
            /* ระยะห่างระหว่างปุ่มและช่องค้นหา */
        }

        .add-friend-btn {
            padding: 6px 8px;
            /* ปรับขนาด padding ให้ปุ่มใหญ่ขึ้นและมนขึ้น */
            background-color: #FFB703;
            color: #023047;
            border: none;
            cursor: pointer;
            margin-right: 0px;
            /* ช่องว่างระหว่างปุ่ม Add Friend กับช่องค้นหา */
            border-radius: 20px;
            /* ทำให้มุมปุ่มมน ๆ */
            font-size: 14px;
            /* ขนาดฟอนต์ให้เหมาะสม */
        }

        .add-friend-btn:hover {
            background-color: #ffffff;
            /* สีที่เปลี่ยนเมื่อ hover */
        }

        .search-bar-container {
            position: relative;
            width: 180px;
            /* กำหนดความกว้างของ search bar */

        }

        .search-bar {
            padding: 5px 1px;
            width: 100%;
            /* ทำให้ search bar ใช้ความกว้างเต็ม */
            border: 1px solid #ccc;
            border-radius: 20px;
        }

        .search-icon {
            position: absolute;
            right: 3px;
            /* วางไอคอนอยู่ที่ขวาสุด */
            top: 50%;
            transform: translateY(-50%);
            /* จัดให้อยู่กลางแนวแกน Y */
            cursor: pointer;
        }

        .search-icon img {
            width: 17px;
            height: 17px;
        }


        .user-icon img {
            width: 30px;
            /* ขนาดของไอคอนผู้ใช้ */
            height: 30px;
            object-fit: cover;
            /* ป้องกันไม่ให้ไอคอนยืดหรือบิดเบี้ยว */
            border-radius: 50%;
            /* ทำให้เป็นวงกลม */
        }

        .user-icon:hover img {
            transform: scale(1.2);
            /* ขยายขนาดไอคอนขึ้น 1.2 เท่า */
            background-color: #ffffff;
            /* เปลี่ยนสีพื้นหลัง */
            padding: 5px;
            /* เพิ่มพื้นที่รอบ ๆ ไอคอน */
        }

        .menu-btn {
            cursor: pointer;
            font-size: 24px;
            margin-right: 10px;
        }

        /* Sidebar Menu */
        .menu {
            position: absolute;
            top: 60px;
            /* เพิ่มให้ sidebar เริ่มต้นจากด้านล่าง navbar */
            left: -250px;
            width: 200px;
            background-color: #ffffff;
            padding: 15px;
            transition: 0.3s ease-in-out;
            z-index: 999;
            /* ทำให้ menu อยู่หลัง navbar */
        }

        .menu a {
            display: block;
            color: #023047;
            padding: 10px;
            text-decoration: none;
        }

        .menu a:hover {
            background-color: #FFB703;
        }

        .menu.active {
            left: 0;
            /* แสดง menu เมื่อ class active ถูกเพิ่ม */
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            color: #023047;
            padding: 10px;
        }

        .navbar .right-section {
            margin-right: 40px;
            /* ระยะห่างจากขอบขวาของ navbar */
        }

        .profile-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150pt;
        }

        .profile-picture {
            width: 200px;
            /* ขนาดของวงกลม */
            height: 200px;
            /* ขนาดของวงกลม */
            border-radius: 50%;
            /* ทำให้เป็นวงกลม */
            overflow: hidden;
            /* ซ่อนส่วนที่เกินจากกรอบวงกลม */
            border: 4px solid #023047;
            /* ขอบวงกลม */
            position: relative;
            display: flex;
            /* ใช้ flexbox เพื่อจัดตำแหน่ง */
            justify-content: center;
            /* จัดให้อยู่กลางตามแกน X */
            align-items: center;
            /* จัดให้อยู่กลางตามแกน Y */
        }

        .profile-picture img {
            width: 100%;
            /* กำหนดขนาดของไอคอนให้เล็ก ๆ อยู่กลาง */
            height: 100%;
            /* กำหนดขนาดของไอคอนให้เล็ก ๆ อยู่กลาง */
            object-fit: cover;
            /* ทำให้รูปไม่บิดเบี้ยว */
        }



        .homepage-text {
            font-size: 3rem;
            /* ขนาดตัวอักษรที่ใหญ่ */
            font-weight: bold;
            /* ตัวหนา */
            text-align: center;
            /* จัดกลาง */
            color: #023047;
            /* สีที่ตัดกับพื้นหลัง */
            margin-top: 80px;
            /* ให้ข้อความอยู่ห่างจาก navbar */
        }

        .profile-text {
            font-size: 1rem;
            /* ขนาดตัวอักษรที่ใหญ่ */
            font-weight: bold;
            /* ตัวหนา */
            text-align: center;
            /* จัดกลาง */
            color: #023047;
            /* สีที่ตัดกับพื้นหลัง */
            margin-top: 120px;
            /* ให้ข้อความอยู่ห่างจาก navbar */
        }

        .header {
            margin-top: -60px;
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;

        }

        .container {
            width: 100%;
            max-width: 1000px;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            margin-top: 10px;
        }

        .form-row {
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            margin-bottom: 20px;
            gap: 30px;
        }

        .image-upload {
            width: 40%;
            display: flex;
            flex-direction: column;
            /* Stack the image and text vertically */
            justify-content: center;
            align-items: center;
            border: 3px dashed #023047;
            background-color: #ffffff;
            border-radius: 8px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s ease;
            height: 350px;
        }

        .image-upload img {
            width: 100px;
        }

        .image-upload:hover {
            background-color: #f0f8ff;
        }

        .image-upload input[type="file"] {
            display: none;
        }



        .image-upload span {
            font-size: 16px;
            color: #023047;
            text-align: center;
            margin-top: 10px;
            /* Ensures spacing between the image and the text */
        }

        .uploaded-image-container {
            display: none;
            justify-content: center;
            align-items: center;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
        }

        .uploaded-image-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        .delete-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #023047;
            color: white;
            border: none;
            border-radius: 50%;
            padding: 5px;
            cursor: pointer;
        }

        .delete-button:hover {
            background-color: #022130;
        }

        .form-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 55%;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group input,
        .form-group textarea {
            border-radius: 4px;
            background-color: #ffffff;
            color: #000;
            padding: 10px 15px;
            border: 1px solid #ffffff;
            width: 100%;
        }

        .rating {
            display: flex;
            justify-content: flex-start;
        }

        .rating label {
            margin-right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: #ffffff;
        }

        .rating input[type="radio"] {
            display: none;
        }

        .rating input[type="radio"]:checked~label {
            color: #023047;
        }

        .button {
            background-color: #023047;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 50%;
            font-size: 1rem;
            align-self: center;
        }

        .button:hover {
            background-color: #2b617e;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                align-items: stretch;
            }

            .form-row .form-group {
                width: 100%;
            }

            .image-upload {
                width: 100%;
                height: 200px;
            }

            .form-content {
                width: 100%;
            }
        }

        footer {
            width: 100%;
            background-color: #FFB703;
            color: white;
            padding: 20px 0;
            text-align: center;
            position: fixed;
            bottom: 0;
            left: 0;
        }

        footer a {
            color: #023047;
            text-decoration: none;
            margin: 0 10px;
            font-size: 1rem;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .social-icons {
            display: flex;
            /* ใช้ Flexbox เพื่อจัดการตำแหน่ง */
            justify-content: center;
            /* จัดไอคอนให้อยู่ตรงกลาง */
            margin-top: 10px;
            /* ระยะห่างจากเนื้อหาข้างบน */

        }

        /* กำหนดการจัดการกับลิงค์ไอคอน */
        .social-icons a {
            margin: 0 15px;
            /* ระยะห่างระหว่างไอคอน */
            font-size: 2rem;
            /* ปรับขนาดของไอคอนให้พอดีกับ footer */
            color: #023047;
            /* สีไอคอน */
            text-decoration: none;
            /* ไม่มีขีดเส้นใต้ */
        }

        /* เมื่อ hover ไอคอน */
        .social-icons a:hover {
            color: #FFB703;
            /* เปลี่ยนสีไอคอนเมื่อ hover */
            transform: scale(1.1);
            /* ขยายขนาดไอคอนเมื่อ hover */
        }

        .social-icons a img {
            width: 35px;
            /* ขนาดของรูปไอคอน */
            height: 35px;
            /* ขนาดของรูปไอคอน */
            object-fit: cover;
            /* ป้องกันไม่ให้ไอคอนยืดเบี้ยว */
        }


        .menu-btn {
            cursor: pointer;
            font-size: 24px;
            margin-right: 10px;
        }

        /* Sidebar Menu (กลับมาเป็นแบบเก่า) */
        .menu {
            position: absolute;
            left: -250px;
            top: 50px;
            width: 200px;
            background-color: #ffffff;
            padding: 15px;
            transition: 0.3s ease-in-out;
        }

        .menu a {
            display: block;
            color: #023047;
            padding: 10px;
            text-decoration: none;
        }

        .menu a:hover {
            background-color: #FFB703;
        }

        .menu.active {
            left: 0;
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            color: #023047;
            padding: 10px;
        }
    </style>
</head>

<body>
    <div class="navbar">
        <div class="left-section">
            <span class="menu-btn" onclick="toggleMenu()">☰</span>
            <img src="/images/logo.png" alt="Logo" class="Logo">
        </div>
        <div class="right-section">
            <button class="add-friend-btn">Add Friend</button>
            <div class="search-bar-container">
                <input type="text" class="search-bar" placeholder="  Search...">
                <span class="search-icon">
                    <img src="/images/search-icon1.svg" alt="Search Icon">
                </span>
            </div>
            <a href="user_profile.html">
                <span class="user-icon"><img src="/images/user-icon.svg" alt="User Icon"></span>
            </a>
        </div>
    </div>
    <!-- Sidebar Menu -->
    <div class="menu" id="menu">
        <a href="#">Tracking</a>
        <a href="streak_page.html">Streak</a>
        <a href="/ratingPage">Rating Books</a>
        <a href="book_list_page.html">Book List</a>
        <div class="dark-mode-toggle">
            <label>
                <input type="checkbox"> Dark Mode
            </label>
        </div>
    </div>

    <div class="header">
        Rating Books
    </div>

    <div class="container">
        <form id="rating-form" onsubmit="submitForm(event)">
            <div class="form-row">
                <div class="image-upload" onclick="document.getElementById('book-cover').click();">
                    <span><img src="/images/upload.png"></span>
                    <span>Please Upload Book Cover</span>
                    <input type="file" id="book-cover" name="book-cover" onchange="displayImage(event)">
                    <div class="uploaded-image-container" id="uploaded-image-container" style="display: none;">
                        <button type="button" class="delete-button" onclick="deleteImage(event)">×</button>
                        <img id="uploaded-image" src="" alt="Book Cover" />
                    </div>
                </div>
                <div class="form-content">
                    <div class="form-group">
                        <label for="book-name">Book Name</label>
                        <input type="text" id="book-name" name="book-name" required>
                    </div>

                    <div class="form-group">
                        <label for="author">Author</label>
                        <input type="text" id="author" name="author" required>
                    </div>

                    <div class="form-group">
                        <label for="review">Review</label>
                        <textarea id="review" name="review" placeholder="Write your review here..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label>Rating</label>
                        <div class="rating">
                            <input type="radio" id="star1" name="rating" value="1">
                            <label for="star1">★</label>
                            <input type="radio" id="star2" name="rating" value="2">
                            <label for="star2">★</label>
                            <input type="radio" id="star3" name="rating" value="3">
                            <label for="star3">★</label>
                            <input type="radio" id="star4" name="rating" value="4">
                            <label for="star4">★</label>
                            <input type="radio" id="star5" name="rating" value="5">
                            <label for="star5">★</label>
                        </div>
                    </div>

                    <button type="submit" class="button">Confirm</button>
                </div>
            </div>
        </form>
    </div>


    <footer>
        <p>© 2025 bookwormsenpaikawaii | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
        <div class="social-icons">
            <a href="https://www.facebook.com" target="_blank"><img src="/images/facebook.png" alt="Facebook"></a>
            <a href="https://www.instagram.com" target="_blank"><img src="/images/instagram.png" alt="Instagram"></a>
            <a href="https://www.twitter.com" target="_blank"><img src="/images/x.png" alt="X"></a>
        </div>
    </footer>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const form = document.getElementById("rating-form");

            // ฟังก์ชันแสดงภาพที่อัปโหลด
            window.displayImage = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const image = document.getElementById("uploaded-image");
                        const imageContainer = document.getElementById("uploaded-image-container");
                        image.src = e.target.result;
                        image.style.display = "block";
                        imageContainer.style.display = "flex";
                    };
                    reader.readAsDataURL(file);
                }
            };

            // ฟังก์ชันลบภาพ
            window.deleteImage = (event) => {
                event.stopPropagation();
                const fileInput = document.getElementById("book-cover");
                const image = document.getElementById("uploaded-image");
                const imageContainer = document.getElementById("uploaded-image-container");

                fileInput.value = "";
                image.src = "";
                image.style.display = "none";
                imageContainer.style.display = "none";
            };

            // ฟังก์ชันกดดาวให้เปลี่ยนสี
            document.querySelectorAll('input[name="rating"]').forEach((radio) => {
                radio.addEventListener("change", () => {
                    const value = radio.value;
                    document.querySelectorAll(".rating label").forEach((label, index) => {
                        label.style.color = index < value ? "#FFD700" : "#FFFFFF"; // เปลี่ยนเป็นสีทองเมื่อเลือก
                    });
                });
            });

            // ฟังก์ชันเปิด/ปิดเมนู
            window.toggleMenu = () => {
                document.getElementById("menu").classList.toggle("active");
            };

            // ฟังก์ชันบันทึกข้อมูลหนังสือ
            form.addEventListener("submit", async (event) => {
                event.preventDefault();

                // ดึงค่าจากฟอร์ม
                const bookName = document.getElementById("book-name").value;
                const author = document.getElementById("author").value;
                const review = document.getElementById("review").value;
                const rating = document.querySelector('input[name="rating"]:checked')?.value;
                const fileInput = document.getElementById("book-cover").files[0];

                if (!bookName || !author || !review || !rating || !fileInput) {
                    alert("กรุณากรอกข้อมูลให้ครบถ้วน");
                    return;
                }

                // แปลงรูปเป็น Base64
                const reader = new FileReader();
                reader.readAsDataURL(fileInput);
                reader.onloadend = async function () {
                    const bookData = {
                        bookName,
                        author,
                        review,
                        rating,
                        coverImage: reader.result // เก็บรูปเป็น Base64
                    };

                    try {
                        const response = await fetch("/save-book", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify(bookData),
                        });

                        if (response.ok) {
                            alert("บันทึกข้อมูลสำเร็จ!");
                            form.reset();
                            deleteImage(event); // รีเซ็ตภาพ
                        } else {
                            alert("เกิดข้อผิดพลาดในการบันทึกข้อมูล");
                        }
                    } catch (error) {
                        alert("เกิดข้อผิดพลาด: " + error.message);
                    }
                };
            });
        });

    </script>
</body>

</html>